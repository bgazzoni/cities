<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #8cd3fe; -webkit-text-stroke: #8cd3fe}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #c27e65; -webkit-text-stroke: #c27e65}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d7378; -webkit-text-stroke: #6d7378}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca; min-height: 16.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #71c083; -webkit-text-stroke: #71c083}
    span.s1 {font-kerning: none; background-color: #171818}
    span.s2 {font-kerning: none; color: #8cd3fe; background-color: #171818; -webkit-text-stroke: 0px #8cd3fe}
    span.s3 {font-kerning: none; color: #6d6d6d; background-color: #171818; -webkit-text-stroke: 0px #6d6d6d}
    span.s4 {font-kerning: none; color: #cacaca; background-color: #171818; -webkit-text-stroke: 0px #cacaca}
    span.s5 {font-kerning: none; color: #c27e65; background-color: #171818; -webkit-text-stroke: 0px #c27e65}
    span.s6 {font-kerning: none; color: #4689cc; background-color: #171818; -webkit-text-stroke: 0px #4689cc}
    span.s7 {font-kerning: none; color: #6d7378; background-color: #171818; -webkit-text-stroke: 0px #6d7378}
    span.s8 {font-kerning: none; color: #d4d4d4; background-color: #171818; -webkit-text-stroke: 0px #d4d4d4}
    span.s9 {font-kerning: none; color: #a7c598; background-color: #171818; -webkit-text-stroke: 0px #a7c598}
    span.s10 {font-kerning: none; color: #71c083; background-color: #171818; -webkit-text-stroke: 0px #71c083}
    span.s11 {font-kerning: none}
    span.s12 {font-kerning: none; color: #b76ff7; background-color: #171818; -webkit-text-stroke: 0px #b76ff7}
    span.s13 {font-kerning: none; color: #36c0a0; background-color: #171818; -webkit-text-stroke: 0px #36c0a0}
    span.s14 {font-kerning: none; color: #f67c30; background-color: #171818; -webkit-text-stroke: 0px #f67c30}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"en"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">World City Guesser</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com/css2?family=Raleway:wght@300&amp;display=swap"</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s7">&lt;!-- Raleway Light font --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Base styles for full-screen, no-border layout */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">html</span><span class="s8">,</span><span class="s1"> </span><span class="s6">body</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">height:</span><span class="s1"> </span><span class="s9">100%</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">margin:</span><span class="s1"> </span><span class="s9">0</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">overflow:</span><span class="s4"> </span><span class="s5">hidden</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Prevent scrolling if map overflows vertically */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s4"> </span><span class="s10">'Raleway Light'</span><span class="s8">,</span><span class="s4"> </span><span class="s5">sans-serif</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Applied Raleway Light */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0.8</span><span class="s5">)</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* 80% black opacity for general text */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> #000</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Black background for any uncovered areas */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">display:</span><span class="s4"> </span><span class="s5">flex</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Make body a flex container */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">align-items:</span><span class="s4"> </span><span class="s5">center</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Center content vertically */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">justify-content:</span><span class="s4"> </span><span class="s5">center</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Center content horizontally */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.game-container</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">position:</span><span class="s4"> </span><span class="s5">relative</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Important for absolute positioning of children */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">width:</span><span class="s4"> </span><span class="s9">100vw</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Container spans full viewport width */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">height:</span><span class="s4"> </span><span class="s9">100vh</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Container spans full viewport height */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">/* Flex properties of body will center the canvas within this container implicitly */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">canvas</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">display:</span><span class="s1"> </span><span class="s5">block</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border:</span><span class="s1"> </span><span class="s5">none</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">cursor:</span><span class="s1"> </span><span class="s5">crosshair</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> #e2e8f0</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Fallback for canvas background */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">position:</span><span class="s4"> </span><span class="s5">absolute</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Positioned within game-container */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">/* top, left, width, height set by JavaScript for centering and aspect ratio */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Overlay for game information */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.overlay-panel</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">position:</span><span class="s4"> </span><span class="s5">absolute</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Positioned relative to .game-container */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">left:</span><span class="s1"> </span><span class="s9">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">right:</span><span class="s1"> </span><span class="s9">0</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">/* Gradient background from transparent to semi-transparent black */</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background:</span><span class="s4"> </span><span class="s1">linear-gradient(to</span><span class="s4"> </span><span class="s1">top</span><span class="s8">,</span><span class="s4"> </span><span class="s1">rgba(</span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0.6</span><span class="s1">)</span><span class="s8">,</span><span class="s4"> </span><span class="s1">rgba(</span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0</span><span class="s1">))</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s9">15px</span><span class="s1"> </span><span class="s9">20px</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">display:</span><span class="s1"> </span><span class="s5">flex</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">flex-direction:</span><span class="s4"> </span><span class="s5">row</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Arrange items in a row */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">align-items:</span><span class="s4"> </span><span class="s5">center</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Vertically align items in the center */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">justify-content:</span><span class="s4"> </span><span class="s5">space-between</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Distribute space evenly, pushing ends to edges */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">gap:</span><span class="s4"> </span><span class="s9">10px</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Space between elements */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">z-index:</span><span class="s1"> </span><span class="s9">10</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-sizing:</span><span class="s1"> </span><span class="s5">border-box</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">width:</span><span class="s1"> </span><span class="s9">100%</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s4"> #ffffff</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* White text on dark overlay */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">/* bottom and height set by JavaScript */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.info-item</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s4"> </span><span class="s9">600</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Keeping some weight for readability */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">font-size:</span><span class="s4"> </span><span class="s9">1.4em</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Uniform font size for all info items */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s4"> #ffffff</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* White text on dark overlay */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">text-align:</span><span class="s4"> </span><span class="s5">center</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Center text within its own flex item */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">flex-grow:</span><span class="s4"> </span><span class="s9">0</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Prevents score/round from growing unnecessarily */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">flex-shrink:</span><span class="s4"> </span><span class="s9">0</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Prevents score/round from shrinking too much */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">min-width:</span><span class="s4"> </span><span class="s9">80px</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Minimum width for each item */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#city-name-display</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">font-size:</span><span class="s4"> </span><span class="s9">1.4em</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Now same size as other info-items */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-weight:</span><span class="s1"> </span><span class="s9">700</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">text-shadow:</span><span class="s1"> </span><span class="s9">1px</span><span class="s1"> </span><span class="s9">1px</span><span class="s1"> </span><span class="s9">3px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">0</span><span class="s8">,</span><span class="s9">0</span><span class="s8">,</span><span class="s9">0</span><span class="s8">,</span><span class="s9">0.5</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s4"> #ffffff</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* White text on dark overlay */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">flex-grow:</span><span class="s4"> </span><span class="s9">1</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Allow city name to take up available space */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">text-align:</span><span class="s4"> </span><span class="s5">center</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Center the city name text within its flex item */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">min-width:</span><span class="s4"> </span><span class="s9">150px</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Ensure city name has enough space */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#message-box</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">position:</span><span class="s1"> </span><span class="s5">fixed</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">top:</span><span class="s1"> </span><span class="s9">50%</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">left:</span><span class="s1"> </span><span class="s9">50%</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translate(</span><span class="s9">-50%</span><span class="s8">,</span><span class="s1"> </span><span class="s9">-50%</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">background-color:</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0</span><span class="s8">,</span><span class="s4"> </span><span class="s9">0.7</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> </span><span class="s5">white</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding:</span><span class="s1"> </span><span class="s9">20px</span><span class="s1"> </span><span class="s9">30px</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">10px</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">z-index:</span><span class="s1"> </span><span class="s9">1000</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">display:</span><span class="s1"> </span><span class="s5">none</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-size:</span><span class="s1"> </span><span class="s9">1.2em</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">text-align:</span><span class="s1"> </span><span class="s5">center</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">max-width:</span><span class="s1"> </span><span class="s9">80%</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">5px</span><span class="s1"> </span><span class="s9">15px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">0</span><span class="s8">,</span><span class="s9">0</span><span class="s8">,</span><span class="s9">0</span><span class="s8">,</span><span class="s9">0.3</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s4"> </span><span class="s10">'Raleway Light'</span><span class="s8">,</span><span class="s4"> </span><span class="s5">sans-serif</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Apply font to message box as well */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Responsive adjustments for info items */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>@</span><span class="s6">media</span><span class="s1"> (</span><span class="s6">max-width:</span><span class="s1"> 768</span><span class="s6">px</span><span class="s1">) </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>.overlay-panel {</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s2">flex-direction:</span><span class="s4"> </span><span class="s5">column</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Stack vertically on small screens */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s2">align-items:</span><span class="s1"> </span><span class="s5">center</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s2">padding:</span><span class="s4"> </span><span class="s9">10px</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Reduced padding */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">.info-item</span><span class="s8">,</span><span class="s4"> </span><span class="s1">#city-name-display</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s2">width:</span><span class="s4"> </span><span class="s9">100%</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Full width on small screens */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s2">font-size:</span><span class="s4"> </span><span class="s9">1.2em</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Smaller font on small screens */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s2">text-align:</span><span class="s4"> </span><span class="s5">center</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* Ensure all items are centered when stacked */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"game-container"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">canvas</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"gameCanvas"</span><span class="s3">&gt;&lt;/</span><span class="s6">canvas</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"overlay-panel"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"score-display"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"info-item"</span><span class="s3">&gt;</span><span class="s4">0</span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"city-name-display"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span><span class="s4"> </span><span class="s1">&lt;!-- Initial text set by JS --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"round-info"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"info-item"</span><span class="s3">&gt;</span><span class="s4">0 / 10</span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"message-box"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> canvas </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s10">'gameCanvas'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> ctx </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">getContext</span><span class="s8">(</span><span class="s10">'2d'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> scoreDisplay </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s10">'score-display'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> cityNameDisplay </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s10">'city-name-display'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> roundInfoDisplay </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s10">'round-info'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> messageBox </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s10">'message-box'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> overlayPanel </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">querySelector</span><span class="s8">(</span><span class="s10">'.overlay-panel'</span><span class="s8">);</span><span class="s1"> </span><span class="s7">// Get overlay panel element</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> mapImage </span><span class="s8">=</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s13">Image</span><span class="s8">();</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span>mapImage</span><span class="s8">.</span><span class="s4">src </span><span class="s8">=</span><span class="s4"> </span><span class="s1">'https://i.imgur.com/L9eQUyT.jpeg'</span><span class="s8">;</span><span class="s4"> </span><span class="s7">// Confirmed working image source</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> mapLoaded </span><span class="s8">=</span><span class="s1"> </span><span class="s12">false</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> mapAspectRatio </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> mapNaturalWidth </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> mapNaturalHeight </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> score </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> round </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> maxRounds </span><span class="s8">=</span><span class="s1"> </span><span class="s14">10</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s4"> cities </span><span class="s8">=</span><span class="s4"> </span><span class="s8">[];</span><span class="s4"> </span><span class="s1">// Array to hold city data</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> currentCity </span><span class="s8">=</span><span class="s1"> </span><span class="s12">null</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s4"> answeredCities </span><span class="s8">=</span><span class="s4"> </span><span class="s12">new</span><span class="s4"> </span><span class="s13">Set</span><span class="s8">();</span><span class="s4"> </span><span class="s1">// To keep track of cities already asked</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> isDrawing </span><span class="s8">=</span><span class="s1"> </span><span class="s12">false</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> startX</span><span class="s8">,</span><span class="s1"> startY</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> currentRadius </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> playerGuess </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> x</span><span class="s8">:</span><span class="s1"> </span><span class="s14">0</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">:</span><span class="s1"> </span><span class="s14">0</span><span class="s8">,</span><span class="s1"> radius</span><span class="s8">:</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s8">};</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s4"> cityMarker </span><span class="s8">=</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> x</span><span class="s8">:</span><span class="s4"> </span><span class="s14">0</span><span class="s8">,</span><span class="s4"> y</span><span class="s8">:</span><span class="s4"> </span><span class="s14">0</span><span class="s4"> </span><span class="s8">};</span><span class="s4"> </span><span class="s1">// Actual city pixel coordinates</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Game states</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">IDLE</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'idle'</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">PLAYING</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'playing'</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">EVALUATING</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'evaluating'</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s13">GAME_OVER</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'game_over'</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> gameState </span><span class="s8">=</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s8">.</span><span class="s13">IDLE</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Famous cities with approximate coordinates</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Latitude, Longitude (Note: Longitude is positive East, negative West)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> allCities </span><span class="s8">=</span><span class="s1"> </span><span class="s8">[</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'New York'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">40.7128</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">74.0060</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'London'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">51.5074</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">0.1278</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Paris'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">48.8566</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">2.3522</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Tokyo'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">35.6895</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">139.6917</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Sydney'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">33.8688</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">151.2093</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Rio de Janeiro'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">22.9068</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">43.1729</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Cairo'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">30.0444</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">31.2357</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Beijing'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">39.9042</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">116.4074</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Moscow'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">55.7558</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">37.6173</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Rome'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">41.9028</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">12.4964</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Berlin'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">52.5200</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">13.4050</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Madrid'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">40.4168</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">3.7038</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Cape Town'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">33.9249</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">18.4241</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Dubai'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">25.2048</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">55.2708</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Mumbai'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">19.0760</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">72.8777</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Mexico City'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">19.4326</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">99.1332</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Buenos Aires'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">34.6037</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">58.3816</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Seoul'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">37.5665</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">126.9780</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Bangkok'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">13.7563</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">100.5018</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Istanbul'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">41.0082</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">28.9784</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Toronto'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">43.651070</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">79.347015</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Vancouver'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">49.2827</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">123.1207</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Nairobi'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">1.2921</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">36.8219</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Wellington'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s14">41.2865</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">174.7762</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s10">'Oslo'</span><span class="s8">,</span><span class="s1"> lat</span><span class="s8">:</span><span class="s1"> </span><span class="s14">59.9139</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">:</span><span class="s1"> </span><span class="s14">10.7522</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">];</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Function to show a message box</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> showMessageBox</span><span class="s8">(</span><span class="s1">message</span><span class="s8">,</span><span class="s1"> duration </span><span class="s8">=</span><span class="s1"> </span><span class="s14">2000</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>messageBox</span><span class="s8">.</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> message</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>messageBox</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">display </span><span class="s8">=</span><span class="s1"> </span><span class="s10">'block'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setTimeout</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>messageBox</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">display </span><span class="s8">=</span><span class="s1"> </span><span class="s10">'none'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">},</span><span class="s1"> duration</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Map loading and canvas setup</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>mapImage</span><span class="s8">.</span><span class="s1">onload </span><span class="s8">=</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>mapLoaded </span><span class="s8">=</span><span class="s1"> </span><span class="s12">true</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>mapNaturalWidth </span><span class="s8">=</span><span class="s1"> mapImage</span><span class="s8">.</span><span class="s1">naturalWidth</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>mapNaturalHeight </span><span class="s8">=</span><span class="s1"> mapImage</span><span class="s8">.</span><span class="s1">naturalHeight</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>mapAspectRatio </span><span class="s8">=</span><span class="s1"> mapNaturalWidth </span><span class="s8">/</span><span class="s1"> mapNaturalHeight</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>resizeCanvas</span><span class="s8">();</span><span class="s4"> </span><span class="s1">// Set initial canvas size</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>drawMap</span><span class="s8">();</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Start the game automatically once the map is loaded</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>startGame</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">};</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// If the image fails to load, provide a fallback message</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>mapImage</span><span class="s8">.</span><span class="s1">onerror </span><span class="s8">=</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s8">.</span><span class="s4">error</span><span class="s8">(</span><span class="s1">"Failed to load map image from the provided URL."</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// No need to set cityNameDisplay text here, it will just remain empty</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>showMessageBox</span><span class="s8">(</span><span class="s1">"Failed to load map image. Game cannot start."</span><span class="s8">,</span><span class="s4"> </span><span class="s14">5000</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">};</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Handle window resize to maintain map proportions</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s10">'resize'</span><span class="s8">,</span><span class="s1"> resizeCanvas</span><span class="s8">);</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> resizeCanvas</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">mapLoaded</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Set canvas width to span the entire screen</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>canvas</span><span class="s8">.</span><span class="s1">width </span><span class="s8">=</span><span class="s1"> window</span><span class="s8">.</span><span class="s1">innerWidth</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Calculate height to maintain the original aspect ratio based on the full width</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>canvas</span><span class="s8">.</span><span class="s1">height </span><span class="s8">=</span><span class="s1"> window</span><span class="s8">.</span><span class="s1">innerWidth </span><span class="s8">/</span><span class="s1"> mapAspectRatio</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Calculate position to center the canvas vertically within the viewport</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> canvasLeft </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">window</span><span class="s8">.</span><span class="s1">innerWidth </span><span class="s8">-</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">width</span><span class="s8">)</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> </span><span class="s14">2</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> canvasTop </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">window</span><span class="s8">.</span><span class="s1">innerHeight </span><span class="s8">-</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">height</span><span class="s8">)</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> </span><span class="s14">2</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>canvas</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">left </span><span class="s8">=</span><span class="s1"> canvasLeft </span><span class="s8">+</span><span class="s1"> </span><span class="s10">'px'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>canvas</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">top </span><span class="s8">=</span><span class="s1"> canvasTop </span><span class="s8">+</span><span class="s1"> </span><span class="s10">'px'</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Position the overlay panel at the bottom of the canvas, 8% of its height</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>overlayPanel</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">height </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">canvas</span><span class="s8">.</span><span class="s1">height </span><span class="s8">*</span><span class="s1"> </span><span class="s14">0.08</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s10">'px'</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>overlayPanel</span><span class="s8">.</span><span class="s4">style</span><span class="s8">.</span><span class="s4">bottom </span><span class="s8">=</span><span class="s4"> canvasTop </span><span class="s8">+</span><span class="s4"> </span><span class="s10">'px'</span><span class="s8">;</span><span class="s4"> </span><span class="s1">// Aligns the overlay's bottom with canvas's bottom</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>overlayPanel</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">left </span><span class="s8">=</span><span class="s1"> canvasLeft </span><span class="s8">+</span><span class="s1"> </span><span class="s10">'px'</span><span class="s8">;</span><span class="s1"> </span><span class="s7">// Aligns overlay horizontally with canvas</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>overlayPanel</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">width </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">width </span><span class="s8">+</span><span class="s1"> </span><span class="s10">'px'</span><span class="s8">;</span><span class="s1"> </span><span class="s7">// Sets overlay width to canvas width</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>drawMap</span><span class="s8">();</span><span class="s4"> </span><span class="s1">// Redraw map after resizing</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// If a circle was drawn, redraw it</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">gameState </span><span class="s8">===</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s8">.</span><span class="s13">EVALUATING</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>drawPlayerGuessCircle</span><span class="s8">(</span><span class="s1">playerGuess</span><span class="s8">.</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> playerGuess</span><span class="s8">.</span><span class="s1">y</span><span class="s8">,</span><span class="s1"> playerGuess</span><span class="s8">.</span><span class="s1">radius</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>drawCityMarker</span><span class="s8">(</span><span class="s1">cityMarker</span><span class="s8">.</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> cityMarker</span><span class="s8">.</span><span class="s1">y</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> drawMap</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s1">clearRect</span><span class="s8">(</span><span class="s14">0</span><span class="s8">,</span><span class="s1"> </span><span class="s14">0</span><span class="s8">,</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">width</span><span class="s8">,</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">height</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">mapLoaded</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>ctx</span><span class="s8">.</span><span class="s1">drawImage</span><span class="s8">(</span><span class="s1">mapImage</span><span class="s8">,</span><span class="s1"> </span><span class="s14">0</span><span class="s8">,</span><span class="s1"> </span><span class="s14">0</span><span class="s8">,</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">width</span><span class="s8">,</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">height</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Coordinate Conversion Functions ---</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Converts Latitude/Longitude to pixel coordinates on the current canvas</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> latLonToPixel</span><span class="s8">(</span><span class="s1">lat</span><span class="s8">,</span><span class="s1"> lon</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Equirectangular projection</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Longitude: -180 to 180 maps to 0 to canvas.width</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Latitude: 90 to -90 maps to 0 to canvas.height</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> x </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">lon </span><span class="s8">+</span><span class="s1"> </span><span class="s14">180</span><span class="s8">)</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> </span><span class="s14">360</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">width</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> y </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s14">90</span><span class="s1"> </span><span class="s8">-</span><span class="s1"> lat</span><span class="s8">)</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> </span><span class="s14">180</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">height</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> x</span><span class="s8">,</span><span class="s1"> y </span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Game Logic ---</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> startGame</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>score </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>round </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>answeredCities</span><span class="s8">.</span><span class="s4">clear</span><span class="s8">();</span><span class="s4"> </span><span class="s1">// Clear previously answered cities</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>cities </span><span class="s8">=</span><span class="s4"> </span><span class="s8">[...</span><span class="s4">allCities</span><span class="s8">];</span><span class="s4"> </span><span class="s1">// Copy all cities to the playable pool</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>updateInfoDisplays</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>newRound</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> newRound</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">round </span><span class="s8">&gt;=</span><span class="s1"> maxRounds</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>endGame</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>round</span><span class="s8">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>updateInfoDisplays</span><span class="s8">();</span><span class="s1"> </span><span class="s7">// Update all info displays</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>drawMap</span><span class="s8">();</span><span class="s4"> </span><span class="s1">// Clear any previous drawings</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>isDrawing </span><span class="s8">=</span><span class="s1"> </span><span class="s12">false</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentRadius </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>playerGuess </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> x</span><span class="s8">:</span><span class="s1"> </span><span class="s14">0</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">:</span><span class="s1"> </span><span class="s14">0</span><span class="s8">,</span><span class="s1"> radius</span><span class="s8">:</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>cityMarker </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> x</span><span class="s8">:</span><span class="s1"> </span><span class="s14">0</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">:</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s8">};</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Select a new city not yet asked</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> availableCities </span><span class="s8">=</span><span class="s1"> cities</span><span class="s8">.</span><span class="s1">filter</span><span class="s8">(</span><span class="s1">city </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">!</span><span class="s1">answeredCities</span><span class="s8">.</span><span class="s1">has</span><span class="s8">(</span><span class="s1">city</span><span class="s8">.</span><span class="s1">name</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">availableCities</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// If all cities have been asked, reset for replayability or end game</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>showMessageBox</span><span class="s8">(</span><span class="s1">"All cities asked! Resetting city pool."</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>answeredCities</span><span class="s8">.</span><span class="s1">clear</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>availableCities </span><span class="s8">=</span><span class="s1"> </span><span class="s8">[...</span><span class="s1">allCities</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> randomIndex </span><span class="s8">=</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s13">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> availableCities</span><span class="s8">.</span><span class="s1">length</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentCity </span><span class="s8">=</span><span class="s1"> availableCities</span><span class="s8">[</span><span class="s1">randomIndex</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>answeredCities</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s1">currentCity</span><span class="s8">.</span><span class="s1">name</span><span class="s8">);</span><span class="s1"> </span><span class="s7">// Mark this city as asked</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>cityNameDisplay</span><span class="s8">.</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s10">`</span><span class="s8">${</span><span class="s1">currentCity</span><span class="s8">.</span><span class="s1">name</span><span class="s8">}</span><span class="s10">`</span><span class="s8">;</span><span class="s1"> </span><span class="s7">// Just the city name</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>gameState </span><span class="s8">=</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s8">.</span><span class="s13">PLAYING</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> endGame</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>gameState </span><span class="s8">=</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s8">.</span><span class="s13">GAME_OVER</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>cityNameDisplay</span><span class="s8">.</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s10">`Game Over! Final Score: </span><span class="s8">${</span><span class="s1">score</span><span class="s8">}</span><span class="s10">`</span><span class="s8">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>showMessageBox</span><span class="s8">(</span><span class="s1">`Game Over! Your final score is </span><span class="s8">${</span><span class="s4">score</span><span class="s8">}</span><span class="s1"> points!`</span><span class="s8">,</span><span class="s4"> </span><span class="s14">5000</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Automate restart after game over</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setTimeout</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>startGame</span><span class="s8">();</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">},</span><span class="s4"> </span><span class="s14">5000</span><span class="s8">);</span><span class="s4"> </span><span class="s1">// 5-second delay before restarting</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> updateInfoDisplays</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>scoreDisplay</span><span class="s8">.</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s10">`</span><span class="s8">${</span><span class="s1">score</span><span class="s8">}</span><span class="s10">`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>roundInfoDisplay</span><span class="s8">.</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s10">`</span><span class="s8">${</span><span class="s1">round</span><span class="s8">}</span><span class="s10"> / </span><span class="s8">${</span><span class="s1">maxRounds</span><span class="s8">}</span><span class="s10">`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Canvas Event Listeners ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>canvas</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s10">'mousedown'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">gameState </span><span class="s8">!==</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s8">.</span><span class="s13">PLAYING</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> rect </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">getBoundingClientRect</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> scaleX </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">width </span><span class="s8">/</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">width</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> scaleY </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">height </span><span class="s8">/</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">height</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>startX </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">.</span><span class="s1">clientX </span><span class="s8">-</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">left</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> scaleX</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>startY </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">.</span><span class="s1">clientY </span><span class="s8">-</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">top</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> scaleY</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>isDrawing </span><span class="s8">=</span><span class="s1"> </span><span class="s12">true</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentRadius </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>drawMap</span><span class="s8">();</span><span class="s4"> </span><span class="s1">// Clear previous circle if any</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>canvas</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s10">'mousemove'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">isDrawing </span><span class="s8">||</span><span class="s1"> gameState </span><span class="s8">!==</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s8">.</span><span class="s13">PLAYING</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> rect </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">getBoundingClientRect</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> scaleX </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">width </span><span class="s8">/</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">width</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> scaleY </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">height </span><span class="s8">/</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">height</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> currentX </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">.</span><span class="s1">clientX </span><span class="s8">-</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">left</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> scaleX</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> currentY </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">.</span><span class="s1">clientY </span><span class="s8">-</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">top</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> scaleY</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> dist </span><span class="s8">=</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">sqrt</span><span class="s8">(</span><span class="s13">Math</span><span class="s8">.</span><span class="s1">pow</span><span class="s8">(</span><span class="s1">currentX </span><span class="s8">-</span><span class="s1"> startX</span><span class="s8">,</span><span class="s1"> </span><span class="s14">2</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">pow</span><span class="s8">(</span><span class="s1">currentY </span><span class="s8">-</span><span class="s1"> startY</span><span class="s8">,</span><span class="s1"> </span><span class="s14">2</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentRadius </span><span class="s8">=</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">max</span><span class="s8">(</span><span class="s14">3</span><span class="s8">,</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">min</span><span class="s8">(</span><span class="s14">100</span><span class="s8">,</span><span class="s1"> dist</span><span class="s8">));</span><span class="s1"> </span><span class="s7">// Radius between 3px and 100px</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>drawMap</span><span class="s8">();</span><span class="s4"> </span><span class="s1">// Clear and redraw map</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>drawPlayerGuessCircle</span><span class="s8">(</span><span class="s1">startX</span><span class="s8">,</span><span class="s1"> startY</span><span class="s8">,</span><span class="s1"> currentRadius</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>canvas</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s10">'mouseup'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">isDrawing </span><span class="s8">||</span><span class="s1"> gameState </span><span class="s8">!==</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s8">.</span><span class="s13">PLAYING</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>isDrawing </span><span class="s8">=</span><span class="s1"> </span><span class="s12">false</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>playerGuess </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> x</span><span class="s8">:</span><span class="s1"> startX</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">:</span><span class="s1"> startY</span><span class="s8">,</span><span class="s1"> radius</span><span class="s8">:</span><span class="s1"> currentRadius </span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>evaluateGuess</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// For touch devices</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>canvas</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s10">'touchstart'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">gameState </span><span class="s8">!==</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s8">.</span><span class="s13">PLAYING</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>e</span><span class="s8">.</span><span class="s1">preventDefault</span><span class="s8">();</span><span class="s1"> </span><span class="s7">// Prevent scrolling</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> touch </span><span class="s8">=</span><span class="s1"> e</span><span class="s8">.</span><span class="s1">touches</span><span class="s8">[</span><span class="s14">0</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> rect </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">getBoundingClientRect</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> scaleX </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">width </span><span class="s8">/</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">width</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> scaleY </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">height </span><span class="s8">/</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">height</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>startX </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">touch</span><span class="s8">.</span><span class="s1">clientX </span><span class="s8">-</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">left</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> scaleX</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>startY </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">touch</span><span class="s8">.</span><span class="s1">clientY </span><span class="s8">-</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">top</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> scaleY</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>isDrawing </span><span class="s8">=</span><span class="s1"> </span><span class="s12">true</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentRadius </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>drawMap</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>canvas</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s10">'touchmove'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">isDrawing </span><span class="s8">||</span><span class="s1"> gameState </span><span class="s8">!==</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s8">.</span><span class="s13">PLAYING</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>e</span><span class="s8">.</span><span class="s1">preventDefault</span><span class="s8">();</span><span class="s1"> </span><span class="s7">// Prevent scrolling</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> touch </span><span class="s8">=</span><span class="s1"> e</span><span class="s8">.</span><span class="s1">touches</span><span class="s8">[</span><span class="s14">0</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> rect </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">getBoundingClientRect</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> scaleX </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">width </span><span class="s8">/</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">width</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> scaleY </span><span class="s8">=</span><span class="s1"> canvas</span><span class="s8">.</span><span class="s1">height </span><span class="s8">/</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">height</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> currentX </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">touch</span><span class="s8">.</span><span class="s1">clientX </span><span class="s8">-</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">left</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> scaleX</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> currentY </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">touch</span><span class="s8">.</span><span class="s1">clientY </span><span class="s8">-</span><span class="s1"> rect</span><span class="s8">.</span><span class="s1">top</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> scaleY</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> dist </span><span class="s8">=</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">sqrt</span><span class="s8">(</span><span class="s13">Math</span><span class="s8">.</span><span class="s1">pow</span><span class="s8">(</span><span class="s1">currentX </span><span class="s8">-</span><span class="s1"> startX</span><span class="s8">,</span><span class="s1"> </span><span class="s14">2</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">pow</span><span class="s8">(</span><span class="s1">currentY </span><span class="s8">-</span><span class="s1"> startY</span><span class="s8">,</span><span class="s1"> </span><span class="s14">2</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentRadius </span><span class="s8">=</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">max</span><span class="s8">(</span><span class="s14">3</span><span class="s8">,</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">min</span><span class="s8">(</span><span class="s14">100</span><span class="s8">,</span><span class="s1"> dist</span><span class="s8">));</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>drawMap</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>drawPlayerGuessCircle</span><span class="s8">(</span><span class="s1">startX</span><span class="s8">,</span><span class="s1"> startY</span><span class="s8">,</span><span class="s1"> currentRadius</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>canvas</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s10">'touchend'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">isDrawing </span><span class="s8">||</span><span class="s1"> gameState </span><span class="s8">!==</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s8">.</span><span class="s13">PLAYING</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>isDrawing </span><span class="s8">=</span><span class="s1"> </span><span class="s12">false</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>playerGuess </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> x</span><span class="s8">:</span><span class="s1"> startX</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">:</span><span class="s1"> startY</span><span class="s8">,</span><span class="s1"> radius</span><span class="s8">:</span><span class="s1"> currentRadius </span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>evaluateGuess</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> drawPlayerGuessCircle</span><span class="s8">(</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">,</span><span class="s1"> radius</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s1">beginPath</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s1">arc</span><span class="s8">(</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">,</span><span class="s1"> radius</span><span class="s8">,</span><span class="s1"> </span><span class="s14">0</span><span class="s8">,</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s13">PI</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s14">2</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s4">fillStyle </span><span class="s8">=</span><span class="s4"> </span><span class="s10">'rgba(31, 63, 114, 0.5)'</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* #1f3f72 with 50% opacity */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s1">fill</span><span class="s8">();</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s4">strokeStyle </span><span class="s8">=</span><span class="s4"> </span><span class="s10">'rgba(31, 63, 114, 0.8)'</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* #1f3f72 with 80% opacity for border */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s1">lineWidth </span><span class="s8">=</span><span class="s1"> </span><span class="s14">2</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s1">stroke</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> drawCityMarker</span><span class="s8">(</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s1">beginPath</span><span class="s8">();</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s4">arc</span><span class="s8">(</span><span class="s4">x</span><span class="s8">,</span><span class="s4"> y</span><span class="s8">,</span><span class="s4"> </span><span class="s14">5</span><span class="s8">,</span><span class="s4"> </span><span class="s14">0</span><span class="s8">,</span><span class="s4"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s13">PI</span><span class="s4"> </span><span class="s8">*</span><span class="s4"> </span><span class="s14">2</span><span class="s8">);</span><span class="s4"> </span><span class="s1">// Small circle for actual city</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s1">fillStyle </span><span class="s8">=</span><span class="s1"> </span><span class="s10">'#b2496f'</span><span class="s8">;</span><span class="s1"> </span><span class="s7">/* Purple color #b2496f */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>ctx</span><span class="s8">.</span><span class="s1">fill</span><span class="s8">();</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Removed stroke and cross drawing for a plain circle</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> evaluateGuess</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>gameState </span><span class="s8">=</span><span class="s1"> </span><span class="s13">GAME_STATE</span><span class="s8">.</span><span class="s13">EVALUATING</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">currentCity</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>showMessageBox</span><span class="s8">(</span><span class="s1">"Error: No current city to evaluate."</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> actualCityPixel </span><span class="s8">=</span><span class="s1"> latLonToPixel</span><span class="s8">(</span><span class="s1">currentCity</span><span class="s8">.</span><span class="s1">lat</span><span class="s8">,</span><span class="s1"> currentCity</span><span class="s8">.</span><span class="s1">lon</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>cityMarker</span><span class="s8">.</span><span class="s1">x </span><span class="s8">=</span><span class="s1"> actualCityPixel</span><span class="s8">.</span><span class="s1">x</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>cityMarker</span><span class="s8">.</span><span class="s1">y </span><span class="s8">=</span><span class="s1"> actualCityPixel</span><span class="s8">.</span><span class="s1">y</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>drawMap</span><span class="s8">();</span><span class="s1"> </span><span class="s7">// Redraw map</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>drawPlayerGuessCircle</span><span class="s8">(</span><span class="s1">playerGuess</span><span class="s8">.</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> playerGuess</span><span class="s8">.</span><span class="s1">y</span><span class="s8">,</span><span class="s1"> playerGuess</span><span class="s8">.</span><span class="s1">radius</span><span class="s8">);</span><span class="s1"> </span><span class="s7">// Redraw player's guess</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>drawCityMarker</span><span class="s8">(</span><span class="s1">cityMarker</span><span class="s8">.</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> cityMarker</span><span class="s8">.</span><span class="s1">y</span><span class="s8">);</span><span class="s1"> </span><span class="s7">// Draw actual city location</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Calculate distance between guessed center and actual city</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> dx </span><span class="s8">=</span><span class="s1"> actualCityPixel</span><span class="s8">.</span><span class="s1">x </span><span class="s8">-</span><span class="s1"> playerGuess</span><span class="s8">.</span><span class="s1">x</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> dy </span><span class="s8">=</span><span class="s1"> actualCityPixel</span><span class="s8">.</span><span class="s1">y </span><span class="s8">-</span><span class="s1"> playerGuess</span><span class="s8">.</span><span class="s1">y</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> distance </span><span class="s8">=</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">sqrt</span><span class="s8">(</span><span class="s1">dx </span><span class="s8">*</span><span class="s1"> dx </span><span class="s8">+</span><span class="s1"> dy </span><span class="s8">*</span><span class="s1"> dy</span><span class="s8">);</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> pointsAwarded </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">distance </span><span class="s8">&lt;=</span><span class="s1"> playerGuess</span><span class="s8">.</span><span class="s1">radius</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// City is within the circle</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> minRadius </span><span class="s8">=</span><span class="s1"> </span><span class="s14">3</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> maxRadius </span><span class="s8">=</span><span class="s1"> </span><span class="s14">100</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> maxPoints </span><span class="s8">=</span><span class="s1"> </span><span class="s14">1000</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> minPoints </span><span class="s8">=</span><span class="s1"> </span><span class="s14">100</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> scoreRange </span><span class="s8">=</span><span class="s1"> maxPoints </span><span class="s8">-</span><span class="s1"> minPoints</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> radiusRange </span><span class="s8">=</span><span class="s1"> maxRadius </span><span class="s8">-</span><span class="s1"> minRadius</span><span class="s8">;</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> clampedRadius </span><span class="s8">=</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">max</span><span class="s8">(</span><span class="s1">minRadius</span><span class="s8">,</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">min</span><span class="s8">(</span><span class="s1">maxRadius</span><span class="s8">,</span><span class="s1"> playerGuess</span><span class="s8">.</span><span class="s1">radius</span><span class="s8">));</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>pointsAwarded </span><span class="s8">=</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">round</span><span class="s8">(</span><span class="s1">maxPoints </span><span class="s8">-</span><span class="s1"> </span><span class="s8">(</span><span class="s1">clampedRadius </span><span class="s8">-</span><span class="s1"> minRadius</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s8">(</span><span class="s1">scoreRange </span><span class="s8">/</span><span class="s1"> radiusRange</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>pointsAwarded </span><span class="s8">=</span><span class="s1"> </span><span class="s13">Math</span><span class="s8">.</span><span class="s1">max</span><span class="s8">(</span><span class="s1">minPoints</span><span class="s8">,</span><span class="s1"> pointsAwarded</span><span class="s8">);</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>score </span><span class="s8">+=</span><span class="s1"> pointsAwarded</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>showMessageBox</span><span class="s8">(</span><span class="s10">`Correct! You scored </span><span class="s8">${</span><span class="s1">pointsAwarded</span><span class="s8">}</span><span class="s10"> points!`</span><span class="s8">,</span><span class="s1"> </span><span class="s14">3000</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>showMessageBox</span><span class="s8">(</span><span class="s10">"Miss! No points this round."</span><span class="s8">,</span><span class="s1"> </span><span class="s14">3000</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>updateInfoDisplays</span><span class="s8">();</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Automatically start the next round after a delay</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setTimeout</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>newRound</span><span class="s8">();</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s8">},</span><span class="s4"> </span><span class="s14">3000</span><span class="s8">);</span><span class="s4"> </span><span class="s1">// 3-second delay before next round</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s11"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Initial setup</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>resizeCanvas</span><span class="s8">();</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// The display will be empty until map loads and game starts</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s11"></span><br></p>
</body>
</html>
